extends layout

block content
  h1 Patrons
  .create-search-container
    a.button(href="/patrons/new") Create New Patron
    form(method="get")
      label(for="search", class="sr-only") Search patrons
      input(type="search", id="search", name="search", placeholder="Search...", aria-label="Search patrons by name, email, address, zip code, or library ID (e.g., MCL1234)")
      button.search-btn(type="submit") Search
  
  table
    thead
      tr
        th Name
        th Address
        th Email
        th Library ID
        th Zip
    tbody
      each patron in patrons
        tr
          td
            a(href=`/patrons/${patron.id}`)= `${patron.first_name} ${patron.last_name}`
          td= patron.address || ''
          td= patron.email
          td MCL#{String(patron.library_id).padStart(4, '0')}
          td= patron.zip_code || ''
  
  if pagination && pagination.totalPages > 1
    nav.pagination
      ul
        if pagination.currentPage > 1
          li
            a(href=`?page=${pagination.currentPage - 1}${pagination.searchQuery ? `&search=${pagination.searchQuery}` : ''}`) Previous
        - let i = 1
        while i <= pagination.totalPages
          li(class=pagination.currentPage === i ? 'active' : '')
            a(href=`?page=${i}${pagination.searchQuery ? `&search=${pagination.searchQuery}` : ''}`)= i++
        if pagination.currentPage < pagination.totalPages
          li
            a(href=`?page=${pagination.currentPage + 1}${pagination.searchQuery ? `&search=${pagination.searchQuery}` : ''}`) Next
